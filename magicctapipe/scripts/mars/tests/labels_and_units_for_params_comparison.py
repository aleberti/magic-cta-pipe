import math

mars_params = {
    "event_id" : "MRawEvtHeader_1.fStereoEvtNumber",
    "length_M1" : "MHillas_1.fLength", "length_M2" : "MHillas_2.fLength",
    "width_M1" : "MHillas_1.fWidth", "width_M2" : "MHillas_2.fWidth",
    "size_M1" : "MHillas_1.fSize", "size_M2" : "MHillas_2.fSize",
    "slope_M1" : "MHillasTimeFit_1.fP1Grad", "slope_M2" : "MHillasTimeFit_2.fP1Grad",
    "delta_M1" : "MHillas_1.fDelta", "delta_M2" : "MHillas_2.fDelta",
    "cogx_M1" : "MHillas_1.fMeanX", "cogx_M2" : "MHillas_2.fMeanX",
    "cogy_M1" : "MHillas_1.fMeanY", "cogy_M2" : "MHillas_2.fMeanY",
    "hmax" : "MStereoPar.fMaxHeight",
    "corex" : "MStereoPar.fCoreX",
    "corey" : "MStereoPar.fCoreY",
    "az" : "MStereoPar.fDirectionAz",
    "zd" : "MStereoPar.fDirectionZd",
    "impact_M1" : "MStereoPar.fM1Impact", "impact_M2" : "MStereoPar.fM2Impact",
    "hmax_disp" : "MStereoParDisp.fMaxHeight",
    "corex_disp" : "MStereoParDisp.fCoreX",
    "corey_disp" : "MStereoParDisp.fCoreY",
    "az_disp" : "MStereoParDisp.fDirectionAz",
    "zd_disp" : "MStereoParDisp.fDirectionZd",
    "impact_disp_M1" : "MStereoParDisp.fM1Impact", "impact_disp_M2" : "MStereoParDisp.fM2Impact",
    # "n_islands" : "MImagePar_1.fNumIslands",
    "leakage_M1" : "MNewImagePar_1.fLeakage1", "leakage_M2" : "MNewImagePar_2.fLeakage1"

}
mcp_params = {
    "length_M1" : "length", "length_M2" : "length",
    "width_M1" : "width", "width_M2" : "width",
    "size_M1" : "intensity", "size_M2" : "intensity",
    "slope_M1" : "slope", "slope_M2" : "slope",
    "delta_M1" : "psi", "delta_M2" : "psi",
    # the camera frames are defined differently in MARS and ctapipe; 
    # so x -> -y and y -> -x; the sign is added in the scaling factors
    "cogx_M1" : "y", "cogx_M2" : "y",
    "cogy_M1" : "x", "cogy_M2" : "x",
    "hmax" : "h_max",
    "corex" : "core_x",
    "corey" : "core_y",
    "az" : "az",
    "zd" : "alt",
    "impact_M1" : "impact", "impact_M2" : "impact",
    "hmax_disp" : "h_max",
    "corex_disp" : "core_x",
    "corey_disp" : "core_y",
    "az_disp" : "az",
    "zd_disp" : "alt",
    "impact_disp_M1" : "impact", "impact_disp_M2" : "impact",
    # "n_islands" : "n_islands",
    "leakage_M1" : "intensity_width_1", "leakage_M2" : "intensity_width_1"
}
# mcp units are converted into MARS units
scale_factors = {
    "length_M1" : 1000. / 1.0713, "length_M2" : 1000. / 1.0713,
    "width_M1" : 1000. / 1.0713, "width_M2" : 1000. / 1.0713,
    "size_M1" : 1., "size_M2" : 1.,
    "slope_M1" : 0.0033703*1.64*1.0713, "slope_M2" : 0.0033703*1.64*1.0713,
    "delta_M1" : (math.pi * 2.0) / 360., "delta_M2" : (math.pi * 2.0) / 360.,
    "cogx_M1" : -1000. / 1.0713, "cogx_M2" : -1000. / 1.0713,
    "cogy_M1" : -1000. / 1.0713, "cogy_M2" : -1000. / 1.0713,
    "leakage_M1" : 1., "leakage_M2" : 1.,
    "hmax" : 100.,
    "corex" : 100.,
    "corey" : 100.,
    "az" : 1.,
    "zd" : 1.,
    "impact_M1" : 100., "impact_M2" : 100.,
    "hmax_disp" : 100.,
    "corex_disp" : 100.,
    "corey_disp" : 100.,
    "az_disp" : 1.,
    "zd_disp" : 1.,
    "impact_disp_M1" : 100., "impact_disp_M2" : 100.,
    # "n_islands" : 1.
}

# important for the plotting, these are mars units
labels_and_units = {
    "length_M1" : "Length M1 [mm]", "length_M2" : "Length M2 [mm]",
    "width_M1" : "Width M1 [mm]", "width_M2" : "Width M2 [mm]",
    "size_M1" : "Size M1 [phe]", "size_M2" : "Size M2 [phe]",
    "delta_M1" : "Delta M1 [rad]", "delta_M2" : "Delta M2 [rad]",
    "slope_M1" : "Time Gradient M1[time slices/mm]", "slope_M2" : "Time Gradient M2[time slices/mm]",
    "cogx_M1" : "Cog_x M1 [mm]", "cogx_M2" : "Cog_x M2 [mm]",
    "cogy_M1" : "Cog_y M1 [mm]", "cogy_M2" : "Cog_y M2 [mm]",
    "hmax" : "Max height [cm]",
    "corex" : "CoreX [cm]",
    "corey" : "CoreY [cm]",
    "az" : "Azimuth [deg]",
    "zd" : "Zenith [deg]",
    "impact_M1" : "Impact_M1 [cm]", "impact_M2" : "Impact_M2 [cm]",
    "hmax_disp" : "Max height [cm]",
    "corex_disp" : "CoreX [cm]",
    "corey_disp" : "CoreY [cm]",
    "az_disp" : "Azimuth [deg]",
    "zd_disp" : "Zenith [deg]",
    "impact_disp_M1" : "Impact_M1 [cm]", "impact_disp_M2" : "Impact_M2 [cm]",
    "leakage_M1" : "Leakage", "leakage_M2" : "Leakage"
}

# threshold for relative error
threshold = {
    "length_M1" : 0.01, "length_M2" : 0.01,
    "width_M1" : 0.01, "width_M2" : 0.01,
    "size_M1" : 0.01, "size_M2" : 0.01,
    "delta_M1" : 0.05, "delta_M2" : 0.05,
    "slope_M1" : 0.01, "slope_M2" : 0.01,
    "cogx_M1" : 0.01, "cogx_M2" : 0.01,
    "cogy_M1" : 0.01, "cogy_M2" : 0.01,
    "hmax" : 0.01,
    "corex" : 1,
    "corey" : 1,
    "az" : 0.01,
    "zd" : 0.01,
    "impact_M1" : 0.01, "impact_M2" : 0.01,
    "hmax_disp" : 1,
    "corex_disp" : 1,
    "corey_disp" : 1,
    "az_disp" : 1,
    "zd_disp" : 1,
    "impact_disp_M1" : 1, "impact_disp_M2" : 1,
    "leakage_M1" : 0.01, "leakage_M2" : 0.01
}

scaling = {
    "length_M1" : "lin", "length_M2" : "lin",
    "width_M1" : "lin", "width_M2" : "lin",
    "size_M1" : "lin", "size_M2" : "lin",
    "delta_M1" : "lin", "delta_M2" : "lin",
    "slope_M1" : "lin", "slope_M2" : "lin",
    "cogx_M1" : "lin", "cogx_M2" : "lin",
    "cogy_M1" : "lin", "cogy_M2" : "lin",
    "leakage_M1" : "lin", "leakage_M2" : "lin",
    "hmax" : "lin",
    "corex" : "lin",
    "corey" : "lin",
    "az" : "lin",
    "zd" : "lin",
    "impact_M1" : "lin", "impact_M2" : "lin",
    "hmax_disp" : "lin",
    "corex_disp" : "lin",
    "corey_disp" : "lin",
    "az_disp" : "lin",
    "zd_disp" : "lin",
    "impact_disp_M1" : "lin", "impact_disp_M2" : "lin",
}
